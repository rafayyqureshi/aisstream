<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AIS Collision Detection</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" crossorigin=""/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}"/>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js" crossorigin=""></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

</head>
<body>
<div id="left-panel">
    <h2 style="display:flex;justify-content:space-between;align-items:center;">
      Selected Ships <button id="clearSelectedShips">Clear</button>
    </h2>
    <div id="vector-length-container">
      <label for="vectorLengthSlider">Vector length (min):</label>
      <input type="range" id="vectorLengthSlider" min="1" max="120" value="15">
      <span id="vectorLengthValue">15</span>
    </div>
    <div id="selected-ships-info"></div>
    <div id="pair-info"></div>
</div>

<div id="map"></div>

<div id="right-panel">
  <h2 style="display:flex;justify-content:space-between;align-items:center;">
    Collisions
    <button id="infoButton" style="font-size:14px;cursor:pointer;">Info</button>
  </h2>
  <div id="collision-filters">
    <label for="cpaFilter">Max CPA (Nm):</label>
    <input type="range" id="cpaFilter" min="0" max="0.5" step="0.01" value="0.5">
    <span id="cpaValue">0.50</span><br>
    <label for="tcpaFilter">Max TCPA (min):</label>
    <input type="range" id="tcpaFilter" min="1" max="10" step="0.1" value="10">
    <span id="tcpaValue">10</span>
  </div>
  <div id="collision-list"></div>
</div>
<!-- Modal -->
<div id="infoModal" class="modal">
  <div class="modal-content">
    <span id="modalClose" class="modal-close">&times;</span>
    <h2>About This Project</h2>
    <p>
      This is a non-professional, experimental project designed to monitor and detect 
      potential ship collisions at sea using AIS (Automatic Identification System) position 
      reports broadcast by various vessels.
    </p>
    <p>
      <strong>Limitations & Nature of the Project:</strong><br>
      The AIS data source is free and may sometimes be incomplete or inaccurate. Consequently, 
      the information presented here should be considered approximate and not reliable for 
      critical navigation or safety decisions. This project primarily serves as a proof-of-concept 
      and is continuously evolving. Many simplifications and constraints have been implemented 
      to reduce computational costs.
    </p>
    <p>
      <strong>How to Use It:</strong><br>
      In the right-hand panel, you'll find a list of currently detected potential collision scenarios. 
      Only the most critical cases are shown, where:
      <ul>
        <li><strong>CPA (Closest Point of Approach)</strong>: The minimum distance at which two ships 
        will approach each other if they maintain their current speeds and courses.</li>
        <li><strong>TCPA (Time to Closest Point of Approach)</strong>: The time remaining until the 
        ships reach that closest approach point.</li>
      </ul>
      Both values are estimated based on the ships' current AIS data.
      <br><br>
      We display situations where CPA &lt; 0.5 Nm and TCPA &lt; 10 minutes as these are considered 
      more critical. You can also select two ships on the map to visualize their movement vectors 
      and review their CPA/TCPA estimates for those specific vessels.
    </p>
    <p>
      If the calculated CPA exceeds 20 Nm or the TCPA surpasses 180 minutes, no values are displayed 
      to avoid showing irrelevant results.
    </p>
    <p>
      <strong>Color Coding of Ships:</strong><br>
      - Transparent: Incomplete data, unknown length<br>
      - Green (<50 m): Small craft (pilots, fishing boats, yachts), excluded from collision calculations 
        to reduce unnecessary computation<br>
      - Yellow (50-150 m)<br>
      - Orange (150-250 m)<br>
      - Red (>250 m)
    </p>
    <p>
      <strong>Scope & Future Development:</strong><br>
      Currently, the detection area focuses on a portion of the English Channel. 
      While it's theoretically possible to expand coverage globally, that would greatly increase 
      complexity and costs.
    </p>
    <p>
      Enjoy exploring the data! Just remember: this is a demonstration and does not replace 
      professional maritime navigation tools or collision avoidance systems.
    </p>
  </div>
</div>
<script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>